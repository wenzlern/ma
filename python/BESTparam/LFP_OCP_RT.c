/*This file is auto generated and contains the LUT  and the function for
 the BEST parametrization
*/
/*LFP SignatureCurve @25 degree celsius, from DOI: 10.1149/1.3567007*/

#include "fpCommon.h"

const static double data[] = {
2.5895000008, 2.73115146561, 2.89990646799, 3.04765736247,
3.16454951793, 3.25150500448, 3.31336433, 3.35583885537,
3.38415247554, 3.4025493512, 3.41423480048, 3.42150709228,
3.42594921766, 3.42861625535, 3.4301920717, 3.43110926144,
3.43163560166, 3.43193362819, 3.43210024222, 3.43219226409,
3.43224250075, 3.43226962173, 3.43228410711, 3.4322917642,
3.43229577159, 3.43229784874, 3.43229891538, 3.43229945818,
3.43229973202, 3.43229986901, 3.43229993701, 3.43229997054,
3.43229998698, 3.43229999504, 3.43229999903, 3.43230000105,
3.43230000216, 3.43230000284, 3.43230000334, 3.43230000379,
3.43230000424, 3.43230000474, 3.43230000529, 3.43230000593,
3.43230000667, 3.43230000752, 3.43230000853, 3.43230000971,
3.43230001111, 3.43230001277, 3.43230001475, 3.43230001713,
3.43230002001, 3.4323000235, 3.43230002776, 3.43230003298,
3.43230003945, 3.43230004748, 3.43230005755, 3.43230007023,
3.43230008632, 3.4323001069, 3.4323001334, 3.4323001678,
3.43230021279, 3.43230027212, 3.43230035102, 3.43230045684,
3.43230060001, 3.43230079547, 3.4323010648, 3.43230143942,
3.43230196559, 3.43230271197, 3.43230378147, 3.43230532993,
3.43230759558, 3.43231094639, 3.43231595655, 3.43232353135,
3.43233511321, 3.4323530246, 3.43238104487, 3.43242538939,
3.4324963876, 3.432611385, 3.43279980487, 3.43311204734,
3.43363524419, 3.43452130719, 3.43603704589, 3.43865379134,
3.44320710748, 3.45117848112, 3.46518142189, 3.48976466354,
3.5326237861, 3.60604526205, 3.72724118823, 3.9120926526,
4.14326763191};

const static double data_c[] = {
0.231151465607, 0.310406467194, 0.316505896859, 0.264643049935,
0.203847642012, 0.148814812073, 0.10433385089, 0.0707881455385,
0.0467104958302, 0.030082324943, 0.0189577410822, 0.0117144171787,
0.00710916306477, 0.00424285404012, 0.00249300609454,
0.00144352996113, 0.000824366753781, 0.000464640559815,
0.000258635896782, 0.000142258526932, 7.73576343587e-05,
4.16063582231e-05, 2.21424735525e-05, 1.16644815691e-05,
6.08454096485e-06, 3.14378893895e-06, 1.60944369965e-06,
8.1663591045e-07, 4.10825326647e-07, 2.04997137487e-07,
1.01528844887e-07, 4.99714905011e-08, 2.45065057136e-08,
1.20443699458e-08, 6.00936500561e-09, 3.12748626996e-09,
1.78300085807e-09, 1.18571685803e-09, 9.52993683967e-10,
9.01853258739e-10, 9.4652863325e-10, 1.04845332416e-09,
1.19211662764e-09, 1.37358435737e-09, 1.59519775167e-09,
1.86329085494e-09, 2.18742535196e-09, 2.58043408863e-09,
3.05896996622e-09, 3.6444687268e-09, 4.36454561381e-09,
5.25491294923e-09, 6.361985605e-09, 7.74643238444e-09,
9.48802281187e-09, 1.16922822535e-08, 1.44996925577e-08,
1.80984809361e-08, 2.27425314137e-08, 2.87766295237e-08,
3.66722892053e-08, 4.70789820461e-08, 6.08979018324e-08,
7.93889864958e-08, 1.04327384509e-07, 1.38233996694e-07,
1.84717873442e-07, 2.48988896612e-07, 3.38631827468e-07,
4.64784881693e-07, 6.4394975885e-07, 9.00795905423e-07,
1.27254399729e-06, 1.81588018755e-06, 2.61796263601e-06,
3.81410560069e-06, 5.61645960451e-06, 8.36096594981e-06,
1.25849612753e-05, 1.91566607759e-05, 2.94932496145e-05,
4.59316659249e-05, 7.23647841254e-05, 0.000115342723033,
0.000185995613386, 0.000303417272498, 0.000500662346031,
0.000835439318846, 0.00140925984324, 0.00240180169861,
0.00413248415491, 0.00717006159771, 0.01252468978, 0.0219743144018,
0.0385861824158, 0.0674423642182, 0.116280598514, 0.19461740213,
0.306047390549, 0.416026443673, 0.338887861636};

DLL_EXPORT double LFP_OCP_RT(short *err, double *param){
  int index = (int)(param[BATTERY_SOC]*100);
  float rest  = param[BATTERY_SOC]*100- index;
  return data[index] + rest*(data[index+1]-data[index]);
}

DLL_EXPORT double LFP_OCP_RT_c(short *err, double *param){
  int index = (int)(param[BATTERY_SOC]*100);
  float rest  = param[BATTERY_SOC]*100- index;
  return data_c[index] + rest*(data_c[index+1]-data_c[index]);
}
