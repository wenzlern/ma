#!/usr/bin/env python
"""VTK files reader class
This class aims to simplyfie the reading in of vtk files generated by the BEST
tools."""

__author__     = "Nils Wenzler"
__copyright__  = "Nils Wenzler"
__maintainer__ = "Nils Wenzler"
__email__      = "wenzlern@ethz.ch"

#imports
import sys
from vtk import *
from vtk.util.numpy_support import vtk_to_numpy
#import matplotlib.pyplot as plt
import numpy as np


# Read the source file.
reader = vtkUnstructuredGridReader()
reader.SetFileName(sys.argv[1])
#reader.SetScalarsName('current_density')
reader.ReadAllScalarsOn()
reader.ReadAllVectorsOn()
reader.ReadAllFieldsOn()
reader.Update() # Needed because of GetScalarRange
points = reader.GetOutput().GetPoints().GetData()
pointdata = reader.GetOutput().GetCellData().GetScalars()


coordinates = vtk_to_numpy(points)
concentration = vtk_to_numpy(pointdata)

print coordinates
print concentration


#output = reader.GetOutput()
#scalar_range = output.GetScalarRange()
 
# Create the mapper that corresponds the objects of the vtk file
# into graphics elements
#mapper = vtkDataSetMapper()
#mapper.SetInput(output)
#mapper.SetScalarRange(200.0,210.0)
# 
## Create the Actor
#actor = vtkActor()
#actor.SetMapper(mapper)
# 
## Create the Renderer
#renderer = vtkRenderer()
#renderer.AddActor(actor)
#renderer.SetBackground(1, 1, 1) # Set background to white
# 
## Create the RendererWindow
#renderer_window = vtkRenderWindow()
#renderer_window.AddRenderer(renderer)
# 
## Create the RendererWindowInteractor and display the vtk_file
#interactor = vtkRenderWindowInteractor()
#interactor.SetRenderWindow(renderer_window)
#interactor.Initialize()
#interactor.Start()
